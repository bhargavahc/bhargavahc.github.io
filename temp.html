<!DOCTYPE html>
<html>
    <head>
        <title>Programs</title>
    </head>
    <body>
<h1>1st program- 1b</h1>
<pre>
    LEX PART
%{
#include "y.tab.h"
#include &ltstdlib.h>
extern int yylval;
%}
%%
[0-9]+ {yylval=atoi(yytext);
return NUM;}
\n {return 0;}
. {return yytext[0];}
%%
YACC PART
%{
#include&ltstdio.h>
int valid=1;
%}
%token NUM
%left '+' '-'
%left '*' '/'
%%
Stmt:expr{if(valid)
{
printf("Result=%d\n",$$);}
}
expr:expr'+'expr {$$=$1+$3;}
 |expr'-'expr {$$=$1-$3;}
 |expr'*'expr {$$=$1*$3;}
 |expr'/'expr {if($3==0){
valid=0;printf("Divide by zero error\n");}
else
$$=$1/$3;}
 |'('expr')' {$$=$2;}
 |NUM {$$=$1;}
 ;
%%
main()
{
printf("Enter arithmetic exression:\n");
yyparse();
if(valid==1)
printf("Expression is valid\n");
}
int yyerror()
{
printf("Invalid expression\n");
exit(0);
}
</pre>
<h1>1a program </h1>
<br>
<pre>

    %{
        #include&ltstdio.h>
        #include&ltstring.h>
        void fail();
        int noOfOperands=0;
        int noOfOperators=0;
        char Operands[10][10];
        char Operators[10][10];
        int valid=0;
        %}
        %%
        "(" valid++;
        ")" {valid--;
         if(valid&lt 0) fail(); }
         "+"|"*" {strcpy(Operators[noOfOperators],yytext);noOfOperators++;}
        [0-9]+ {strcpy(Operands[noOfOperands],yytext);noOfOperands++;}
        [^+*]"("[^0-9] fail();
        [+*]")" fail();
        %%
        int main()
        {
        int i=0;
        printf("Enter a mathematical expression and press ctrl + d for output \n");
        yylex();
        printf("Number of  Operators are :%d\n Number of Operands are : %d\n",noOfOperators,noOfOperands);
        if(valid==0 && (noOfOperands-noOfOperators)==1)
        {
        printf("Expression is valid\n");
        printf("Operands are :\n");
        for (i=0;i &lt noOfOperands;i++) printf("%s\n", Operands[i]);
        printf("Operators are :\n");
        for (i=0;i&lt noOfOperators;i++) printf("%s\n",Operators[i]);
        }
        else
        {
        printf("Invalid Expression\n");
        }
        return 0;
        }
        void fail()
        {
        printf("The Expression is invalid\n");
        exit(0);
        }
        
        
</pre>
<br>
<pre>
    <h1>2nd program</h1>
    LEX PART
%{
#include "y.tab.h"
%}
%%
a {return A;}
b {return B;}
\n {return 0;}
. {return yytext[0];}
%%
YACC PART
%{
#include &ltstdio.h>
int aCount=0,n;
%}
%token A
%token B
%%
s : X B { if (aCount&ltn || aCount>n) 
 {
YYFAIL();
}}
X : X T | T
T : A { aCount++;} 
 ;
%%
int main()
{ printf("Enter the value of n \n");
scanf("%d",&n);
printf("Enter the string\n");
yyparse();
printf("Valid string\n");
}
int YYFAIL()
{
printf("Invalid count of 'a'\n");
exit(0);
}
int yyerror()
{
    printf("Invalid string\n");
exit(0);
}
</pre>

<pre>
    <h1>5h Program</h1>
    #include&ltstdio.h>
        #include&ltstdlib.h>
        #include&ltctype.h>
        char op[2],arg1[5],arg2[5],result[5];
        void main()
        {
        FILE *fp1,*fp2;
        fp1=fopen("5input.txt","r");
        fp2=fopen("5output.txt","w");
        while(!feof(fp1))
        {
        fscanf(fp1,"%s%s%s%s",result,arg1,op,arg2);
        if(strcmp(op,"+")==0)
        {
        fprintf(fp2,"\nMOV R0,%s",arg1);
        fprintf(fp2,"\nADD R0,%s",arg2);
        fprintf(fp2,"\nMOV %s,R0",result);
        }if(strcmp(op,"*")==0)
        {
        fprintf(fp2,"\nMOV R0,%s",arg1);
        fprintf(fp2,"\nMUL R0,%s",arg2);
        fprintf(fp2,"\nMOV %s,R0",result);
        }
        if(strcmp(op,"-")==0)
        {
        fprintf(fp2,"\nMOV R0,%s",arg1);
        fprintf(fp2,"\nSUB R0,%s",arg2);
        fprintf(fp2,"\nMOV %s,R0",result);
        }
        if(strcmp(op,"/")==0)
        {
        fprintf(fp2,"\nMOV R0,%s",arg1);
        fprintf(fp2,"\nDIV R0,%s",arg2);
        fprintf(fp2,"\nMOV %s,R0",result);
        }
        if(strcmp(op,"=")==0)
        {
        fprintf(fp2,"\nMOV R0,%s",arg1);
        fprintf(fp2,"\nMOV %s,R0\n",result);
        } }
        fclose(fp1);
fclose(fp2);
}
</pre>
<pre>
    <h1>6b</h1>
    LEX PART
%{
#include &ltstdio.h>
#include "y.tab.h"
%}
%%
int|char|bool|float|void|for|do|while|if|else|return|void|main {printf("keyword is 
%s\n",yytext);return KEY;}
[+|-|*|/|=|<|>] {printf("operator is %s\n",yytext);return OP;}
[a-zA-Z][_a-zA-Z0-9]* {printf("identifier is %s\n",yytext);return ID;}
. ;
%%
YACC PART
%{
#include &ltstdio.h>
#include &ltstdlib.h>
int id=0, key=0, op=0;
%}
%token ID KEY OP 
%%
input: ID input { id++; }
| KEY input { key++; }
| OP input {op++;}
| ID { id++; }
| KEY { key++; }
| OP { op++;}
;
%%
extern FILE *yyin;
void main(int argc ,char** argv) 
{
yyin = fopen(argv[1],"r");
yyparse();
printf("Keywords = %d\nIdentifiers = %d\noperators = %d\n", key,id, op);
}
void yyerror()
{
printf("Not valid");
}
</pre>


<h1>6a Program Comment lines</h1>
<pre>


    %{
        #include&lt stdio.h>
        int comcount=0;
        %}
        %s COMMENT
        %%
        "/*" {BEGIN (COMMENT);}
        &ltCOMMENT>. {;}
        &ltCOMMENT>"*/" {BEGIN(INITIAL);comcount++;}
        "//".* {; comcount++;}
        .|\n {fprintf(yyout,"%s",yytext);}
        %%
        void main()
        {
        yyin=fopen("input.c","r");
        yyout=fopen("output.c","w");
        yylex();
        printf("No. of comment lines are: %d\n",comcount);
        }
        int yywrap()
        {
        return 1;
        }
</pre>
<br>
        
<br>
        
             <strong> 7th Program</strong>
                <pre>
                        #include&ltstdio.h> 
                        #include&ltstdlib.h>
                        
                        int no;
                        void roundrobin(int,int,int[],int[]);
                        void srtf();
                        main()
                        {
                            int n,tq,choice;
                            int bt[10], st[10], i,j,k;
                            for(;;)
                            {
                                printf("Enter choice\n");
                                printf("1.Round Robin \n2.str \n3.Exit\n");
                                scanf("%d",&choice);
                                switch(choice)
                                {
                                    case 1: printf("Round robin scheduling algorithm\n");
                                        printf("Enter the number of process\n");
                                        scanf("%d",&n);
                                        printf("Enter burst time for sequences\n");
                                        for(i=0;i < n ; i++)

                                        {
                                             scanf("%d" ,&bt[i]);
                                            st[i]=bt[i];
                                        }
                                        
                                        printf("Enter time quantum\n");
                                        scanf("%d",&tq);
                                        roundrobin(n,tq,st,bt);
                                        break;
                                    case 2: printf("\n\n-------------------Shortest remaining time------\n\n");
                                            printf("\n");
                                        srtf();
                                        break;
                                    case 3: exit(0);
                                        break;
                                }
                            }
                        }
                            
                        void roundrobin(int n, int tq, int st[], int bt[])
                        {
                            int time=0;
                            int tat[10],wt[10],i,count=0,swt=0,stat=0,temp1,sq=0,j,k;
                            float awt=0.0, atat=0.0; 
                            while(1)
                            {
                        for(i=0,count=0;i< n;i++)
                                {
                                    temp1=tq;
                                    if(st[i]==0)
                                    {
                                        count++;
                                        continue;
                                    }
                                    if (st[i]>tq)
                                        st[i]=st[i]-tq;
                                    else if(st[i]>=0)
                                    {
                                        temp1=st[i];
                                        st[i]=0;
                                    }
                                    sq=sq+temp1;
                                    tat[i]=sq;
                                }
                                if(n==count)
                                break;
                            }
                            for(i=0;i< n;i++)
                            {
                                wt[i]=tat[i]-bt[i];
                                swt=swt+wt[i];
                                stat=stat+tat[i];
                            }
                            awt=(float)swt/n;
                            atat=(float)stat/n;
                            printf("process no   burst time  waiting time 	turnaround time\n");
                            for(i=0;i< n;i++)
                                printf("%d \t\t %d \t\t %d \t\t %d \t\t\n",i+1,bt[i],wt[i],tat[i]);
                            printf("average waiting time is%f\n avg turnaround time is %f\n",awt,atat);
                            
                        }
                        
                        void srtf()
                        {
                            int n,j=0,st[10],bt[10],rt[10],remain=0,smallest,time=0,i,endtime,swt=0,stat=0;
                            printf("enter the no. of process:");
                            scanf("%d",&n);
                            for(i=0;i< n;i++)
                            {
                                printf("enter the arrivaltime for p[%d]:",i+1);
                                scanf("%d",&st[i]);
                                printf("enter the burst time for p[%d]:",i+1);
                                scanf("%d",&bt[i]);
                                rt[i]=bt[i];
                            }
                            rt[100]=999;
                        printf("process\t|writing time\t|turnarround time\n");
                            for(time=0;remain!=n;time++)
                             {
                                 smallest=100;
                                 for(i=0;i< n;i++)
                                {
                                    if(st[i]<=time && rt[i]< rt[smallest] && rt[i]>0)
                                    {
                                        smallest=i;
                                    }
                                }
                                rt[smallest]--;
                                if(rt[smallest]==0)
                                {
                                    remain++;
                                    endtime=time+1;
                                    j=smallest;
                                    printf("p[%d]\t|\t%d\t|\t%d\n",smallest+1,endtime-bt[j]-st[j],endtime-st[j]);
                                    swt +=endtime-bt[j]-st[j];
                                    stat +=endtime-st[j];
                                }
                            }
                            float awt=0.0,atat=0.0;
                            awt=(float)swt/n;
                            atat=(float)stat/n;
                            printf("average waiting time:%f\n",awt);
                            printf("average turnarround time:%f\n",atat);
                        }
                        
                        
                </pre>
           

            
            </body>
</html>